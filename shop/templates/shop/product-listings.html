{% extends 'shop/base.html' %}
{% load static %}
{% block extra_styles %} <link rel="stylesheet" href="{% static 'shop/css/product-listings.css' %}"> {% endblock extra_styles %}
{% block content %}

    <main id="main-container" class="container section page-product-listings">
      <div class="section__header">
        <div>
          <h1 class="section__title">All products</h1>
          <p class="section__subtitle">Browse by category or sort to review inventory.</p>
        </div>
      </div>

      <div class="layout">
        <section>
          <div class="product-toolbar">
            <div class="badge">Showing 4 products</div>
            <div style="display:flex; gap: var(--space-md); align-items:center; flex-wrap:wrap;">
              <div class="chip-group">
                <a class="chip" href="#">Outerwear</a>
                <a class="chip" href="#">Footwear</a>
                <a class="chip" href="#">Accessories</a>
                <a class="chip" href="#">Lifestyle</a>
              </div>
              <label>
                <span class="section__subtitle">Sort by</span>
                <select class="form__control">
                  <option>Recommended</option>
                  <option>Newest</option>
                  <option>Price: Low to High</option>
                  <option>Price: High to Low</option>
                </select>
              </label>
            </div>
          </div>

          <div class="product-grid">
        {% for product in products %}
          <article class="card product-card">
          
          <a 
          class="product-card__link" 
          hx-push-url="true"
          href="{% url 'shop:product-detail' product.slug %}"
          >   
              <div class="product-card__image">
              <img src="{{product.first_image_for_cover}}" alt="Structured blazer">
              </div>
              <h3 class="product-card__title">{{product.name}}</h3>
              <div class="product-card__meta">
              <span>${{product.details.0.unit_price}}</span>
              <span class="rating">
                  <svg class="star" viewBox="0 0 24 24"><polygon points="12 2 15.1 8.4 22 9.2 17 14.1 18.3 21 12 17.5 5.7 21 7 14.1 2 9.2 8.9 8.4 12 2"/></svg>
                  4.8
              </span>
              </div>
          </a>
          <button  
          class="btn btn--secondary" 
          type="button"
          hx-post="{% url 'shop:add-to-cart' %}"
          hx-vals = '{
              "id": "{{ product.id }}",
              "name": "{{ product.name}}",
              "image_url": "{{ product.first_image_for_cover }}",
              "image_id": "{{ product.details.0.image_id}}",
              "price": "{{ product.details.0.unit_price }}",
              "color": "{{ product.details.0.color }}",
              "curr_total_quantity": "{{ product.details.0.quantity }}",
              "quantity_requested":"",
              "size": "{{ product.details.0.size }}",
              "slug": "{{ product.slug }}",
              "from": "index"
          }'
          hx-target="#cart-count-top"
          hx-swap="outerHTML"
          >Add to cart <span id="cart-counter-on-product-{{product.id}}" class="btn__counter">{{product.quantity_in_cart}}</span></button>
          </article>
        {% endfor %}
          </div>
        </section>
      </div>
    </main>
{% endblock content %}

    <!-- <footer class="footer">
      <div class="container footer__inner">
        <div class="footer__grid">
          <div>
            <h4 class="footer__title">Northwind Commerce</h4>
            <p class="section__subtitle">Considered goods designed to last. Based in Seattle, serving customers worldwide.</p>
          </div>
          <div>
            <h4 class="footer__title">Company</h4>
            <ul>
              <li><a class="footer__link" href="about.html">About</a></li>
              <li><a class="footer__link" href="contact.html">Contact</a></li>
              <li><a class="footer__link" href="index.html">Home</a></li>
            </ul>
          </div>
          <div>
            <h4 class="footer__title">Support</h4>
            <ul>
              <li><span class="footer__link">help@northwind.com</span></li>
              <li><span class="footer__link">+1 (555) 234-8890</span></li>
              <li><span class="footer__link">Mon–Fri, 9am–6pm PT</span></li>
            </ul>
          </div>
          <div>
            <h4 class="footer__title">Newsletter</h4>
            <form class="footer__newsletter">
              <input class="form__control" type="email" placeholder="Work email">
              <button class="btn btn--primary" type="button">Subscribe</button>
            </form>
          </div>
        </div>
        <div class="divider"></div>
        <p class="section__subtitle">© 2025 Northwind Commerce. Crafted for discerning professionals.</p>
      </div>
    </footer>
  </div>
</body>
</html> -->
