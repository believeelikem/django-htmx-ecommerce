<form id = "form" class="card" method=""
    enctype="multipart/form-data"
    hx-post="{% url 'add-product-to-list' %}"
    hx-trigger="submit"
    hx-target=".customers-table"
    hx-swap="innerHTML transition:true"
    >
    <div class="form-grid">
    <div class="form__group">
        <!-------   PRODUCT NAME    ------->
        <label class="form__label" for="name">Product name</label>
        <input 
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-name"
        hx-swap="outerHTML"
        required

        {% if product.product_name %}
            value="{{product.product_name}}"
        {% endif %}

        id="product_name" placeholder="enter product name" name="product_name" class="form__control" type="text" >
        <small style="color: red;" class="product-errors-name">
        </small>        
    </div>
    
    <!-------   PRODUCT CATEGORY   ------->
    <div class="form__group">
        <label class="form__label" for="category">Category</label>
        <select 
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors"
        hx-swap="outerHTML"
        required
        id="category" class="form__control" name="category_name">
        <option value="">Select Category </option>
        {% for category in categories %}
            <option value="{{category.slug}}" 

            {% if product.category_name %}
                {%  if product.category_name == category.name %} selected {% endif %}
            {% endif %}

             > {{category.name}}</option>

        {% endfor %}
        </select>
        <small style="color: red;" class="product-errors-category">
        </small>
    </div>

    <!-------   PRODUCT TAG   ------->
    <div class="form__group">
        <label class="form__label" for="tags">Tags</label>
        <input 
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-tag"
        hx-swap="outerHTML"
        required
        name="tag_name" placeholder="enter tags" id="tags" class="form__control" type="text" 
            {% if product.tag_name %} 
            value="{{product.tag_name}}"
            {% endif %}
        >
        <small style="color: red;" class="product-errors-tag">
        </small>
    </div>

    <!-------   PRODUCT IS-DIGITAL   ------->
    <div class="form__group" style="display:flex; gap: var(--space-sm); align-items:center;">
        <input name="is_digital" id="is_digital" 
        type="checkbox" 

        {% if product.is_digital %}
            {% if product.is_digital == "on" %}
                checked
            {% endif %}
        {% endif %}

        >
        <label for="is_digital">Is digital(wont' be shipped)</label>
    </div>
    
    </div>
    
    <!-------   PRODUCT QUANTITY   ------->
    <div class="form-grid">
    <div class="form__group">
        <label class="form__label" for="quantity">Quantity</label>
        <input
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-quantity"
        hx-swap="outerHTML"   
        required       
        name="quantity" placeholder="enter product quantity" id="quantity" class="form__control" type="text" pattern="[0-9]+" 
        {% if product.quantity %}
            value="{{product.quantity}}" 
        {% endif %}
        >
        <small style="color: red;" class="product-errors-quantity">
        </small>        
    </div>

    <!-------   PRODUCT SIZE   ------->
    <div class="form__group">
        <label class="form__label" for="size">Size</label>
        <input 
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-size"
        hx-swap="outerHTML"  
        required       
        name="size" id="size" placeholder="enter product size" class="form__control" type="text" 
        {% if product.size %}
            value="{{product.size}}"
        {% endif %}
        >
        <small style="color: red;" class="product-errors-size">
        </small>
    </div>

    <!-------   PRODUCT COLOR   ------->
    <div class="form__group">
        <label class="form__label" for="colors">Colors</label>
        <input
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-color"
        hx-swap="outerHTML"
        required
        name="color" placeholder="enter product color" id="colors" class="form__control" type="text" 
        
        {% if product.color %}
            value="{{product.color}}"
        {% endif %}
        >
        <small style="color: red;" class="product-errors-color">
        </small>
    </div>

    <!-------   PRODUCT PRICE  ------->
    <div class="form__group">
        <label class="form__label" for="price">Price</label>
        <input
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-price"
        hx-swap="outerHTML"
        required
        name="price" placeholder="enter product price" id="price" class="form__control" type="text" 
        
        {% if product.price %}
            value="{{product.price}}"
        {% endif %}
        >
        <small style="color: red;" class="product-errors-price">
        </small>
    </div>
    </div>

    <!-------   PRODUCT IMAGE   ------->
    <div class="form-grid">
    <div class="form__group" >
        <label class="form__label" for="image-file">Upload image</label>

        <input 
        hx-post="{% url 'validate-product-error' %}"
        hx-trigger="change"
        hx-target=".product-errors-image"
        hx-encoding="multipart/form-data"
        hx-swap="outerHTML"
        {% if is_create_view %}required {% endif %}
        name="product_image"  id="image-file" class="form__control" type="file">
        <small style="color: red;" class="product-errors-image">
        </small>

    </div>

    <!-------   PRODUCT DESCRIPTION    ------->
    <div class="form__group" margin-top: var(--space-lg);">
        <label class="form__label" for="description">Description</label>
        <textarea
        hx-get="{% url 'validate-product-error' %}"
        hx-trigger="keyup changed delay:300ms"
        hx-target=".product-errors-description"
        hx-swap="outerHTML"
        required
        name="description"
        placeholder="enter product description" 
        id="description" 
        class="form__control textarea">{{product.description}}</textarea>
        <small style="color: red;" class="product-errors-description">
        </small>          </div>
    </div>

    <div class="profile__actions" style="justify-content:flex-end;">
        {% if product.image_url %}
            <div class="current-image-preview">
                <button 
                type="button"
                class="see-btn"
                hx-get="{% url 'product-image-modal' product.product_id %}"
                hx-target="body"
                hx-swap="beforeend"
                >
                    See<svg fill="#0d3b66"  style="display: inline-flex;color:white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><!--!Font Awesome Free v7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2025 Fonticons, Inc.--><path d="M320 96C239.2 96 174.5 132.8 127.4 176.6C80.6 220.1 49.3 272 34.4 307.7C31.1 315.6 31.1 324.4 34.4 332.3C49.3 368 80.6 420 127.4 463.4C174.5 507.1 239.2 544 320 544C400.8 544 465.5 507.2 512.6 463.4C559.4 419.9 590.7 368 605.6 332.3C608.9 324.4 608.9 315.6 605.6 307.7C590.7 272 559.4 220 512.6 176.6C465.5 132.9 400.8 96 320 96zM176 320C176 240.5 240.5 176 320 176C399.5 176 464 240.5 464 320C464 399.5 399.5 464 320 464C240.5 464 176 399.5 176 320zM320 256C320 291.3 291.3 320 256 320C244.5 320 233.7 317 224.3 311.6C223.3 322.5 224.2 333.7 227.2 344.8C240.9 396 293.6 426.4 344.8 412.7C396 399 426.4 346.3 412.7 295.1C400.5 249.4 357.2 220.3 311.6 224.3C316.9 233.6 320 244.4 320 256z"/></svg>
                </button>
                <p class="form__hint">Leave this field empty to keep the current image.</p>
            </div>
        {% endif %}

    <button
        id="add-btn-1"
        style=" transform:scale(1.1); transition: all .5s ease;"
        {% if is_create_view %}
            class="btn" 
        {% else %}
            class="btn is_create_view"
        {% endif %}
        type="submit"
        class="btn"
        >Add to list</button>
    <!-- <a class="btn btn--ghost" href="{% url 'admin-products' %}">Cancel</a> -->
    </div>

</form>

{% if not is_create_view %}
    <table
    id="edit-delete-{{product.product_id}}"
    hx-swap-oob="true"
    >
        <td 
        style="display:flex; gap: var(--space-sm); align-items:center;"     
        >    
            <button 
            hx-delete="{% url 'delete-post-single' product.product_id %}"
            hx-target=".table"
            hx-swap="outerHTML"
            disabled
            class="btn"  style="background-color:brown;opacity:0.5" type="button">Delete</button>   

            <button
            hx-get="{% url 'edit-post-single' product.product_id %}"
            hx-target="#form"
            hx-swap="outerHTML show:window:top transition:true"
            hx-push-url="true"
            class="btn"  style="background-color:#0d3b66" type="button">Edit</button>   
        </td>
    </table>
{% endif %}

{% if a_product_already_being_edited_id %}
    <table
    id="edit-delete-{{a_product_already_being_edited_id.product_id}}"
    hx-swap-oob="true"
    >
        <td 
        style="display:flex; gap: var(--space-sm); align-items:center;"     
        >    
            <button 
            hx-delete="{% url 'delete-post-single' a_product_already_being_edited_id.product_id %}"
            hx-target=".table"
            hx-swap="outerHTML"
            hx-confirm="Are you sure you want to delete product {{a_product_already_being_edited_id.product_name}}"
            class="btn"  style="background-color:brown" type="button">Delete</button>   

            <button
            hx-get="{% url 'edit-post-single' a_product_already_being_edited_id.product_id %}"
            hx-target="#form"
            hx-swap="outerHTML show:window:top transition:true"
            hx-push-url="true"
            class="btn"  style="background-color:#0d3b66" type="button">Edit</button>   
        </td>
    </table>
{% endif %}